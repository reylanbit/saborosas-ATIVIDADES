<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Atividade 16 - Dashboard com Promise.all()</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif; line-height: 1.6; margin: 0; }
    .container { max-width: 1000px; margin: 0 auto; padding: 24px; }
    .status { display: flex; align-items: center; gap: 8px; color: #6b7280; }
    .spinner { width: 20px; height: 20px; border: 3px solid #e5e7eb; border-top-color: #2563eb; border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 16px; }
    @media (max-width: 860px) { .grid { grid-template-columns: 1fr; } }
    .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; background: #fff; }
    .card h3 { margin: 0 0 8px; }
    ul { padding-left: 18px; margin: 0; }
    .error { color: #ef4444; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Missão do Dia: Dashboard com Promise.all()</h1>
    <div id="loading" class="status"><div class="spinner" aria-hidden="true"></div><span>Carregando dados...</span></div>
    <div id="error" class="status error"></div>
    <div class="grid">
      <div class="card">
        <h3>Usuários</h3>
        <ul id="users"></ul>
      </div>
      <div class="card">
        <h3>Posts</h3>
        <ul id="posts"></ul>
      </div>
      <div class="card">
        <h3>Todos</h3>
        <ul id="todos"></ul>
      </div>
    </div>
  </div>
  <script>
    var loading = document.getElementById('loading');
    var errorEl = document.getElementById('error');
    var usersEl = document.getElementById('users');
    var postsEl = document.getElementById('posts');
    var todosEl = document.getElementById('todos');
    function renderUsers(data) {
      for (var i = 0; i < Math.min(5, data.length); i++) {
        var li = document.createElement('li');
        li.textContent = data[i].name + ' (' + data[i].email + ')';
        usersEl.appendChild(li);
      }
    }
    function renderPosts(data) {
      for (var i = 0; i < Math.min(5, data.length); i++) {
        var li = document.createElement('li');
        li.textContent = data[i].title;
        postsEl.appendChild(li);
      }
    }
    function renderTodos(data) {
      for (var i = 0; i < Math.min(5, data.length); i++) {
        var li = document.createElement('li');
        li.textContent = (data[i].completed ? '✓ ' : '• ') + data[i].title;
        todosEl.appendChild(li);
      }
    }
    function loadAll() {
      loading.style.display = 'flex';
      errorEl.textContent = '';
      var f1 = fetch('https://jsonplaceholder.typicode.com/users').then(function (r) { return r.json(); });
      var f2 = fetch('https://jsonplaceholder.typicode.com/posts').then(function (r) { return r.json(); });
      var f3 = fetch('https://jsonplaceholder.typicode.com/todos').then(function (r) { return r.json(); });
      Promise.all([f1, f2, f3])
        .then(function (arr) {
          renderUsers(arr[0]);
          renderPosts(arr[1]);
          renderTodos(arr[2]);
          loading.style.display = 'none';
        })
        .catch(function () {
          Promise.allSettled([f1, f2, f3]).then(function (results) {
            for (var i = 0; i < results.length; i++) {
              var r = results[i];
              if (r.status === 'fulfilled') {
                if (i === 0) renderUsers(r.value);
                if (i === 1) renderPosts(r.value);
                if (i === 2) renderTodos(r.value);
              }
            }
            errorEl.textContent = 'Alguns dados não puderam ser carregados.';
            loading.style.display = 'none';
          });
        });
    }
    loadAll();
  </script>
</body>
</html>
